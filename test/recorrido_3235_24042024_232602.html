<!DOCTYPE HTML>
<html>

<head>
  <script src="https://unpkg.com/wrld.js@1.x.x"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.css" rel="stylesheet"/>
</head>

<style>
  html,
  body,
  #map {
    margin: 0;
    width: 100%;
    height: 100%;
  }

  #mapWrapper {
    padding: 10px;
    margin: 10px;
    width: 100%;
    height: 100%;
  }
</style>


<style>
  .arrow-icon {
    width: 14px;
    height: 14px;
  }

  .arrow-icon>div {
    margin-left: -1px;
    margin-top: -3px;
    transform-origin: center center;
    font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
  }
</style>


<body>
  <div id="mapWrapper">
    <div id="map"></div>
  </div>
</body>




<script>
  function getArrows(arrLatlngs, color, arrowCount, mapObj) {

    if (typeof arrLatlngs === undefined || arrLatlngs == null ||
      (!arrLatlngs.length) || arrLatlngs.length < 2)
      return [];

    if (typeof arrowCount === 'undefined' || arrowCount == null)
      arrowCount = 1;

    if (typeof color === 'undefined' || color == null)
      color = '';
    else
      color = 'color:' + color;

    var result = [];
    for (var i = 1; i < arrLatlngs.length; i++) {
      var icon = L.divIcon({ className: 'arrow-icon', bgPos: [5, 5], html: '<div style="' + color + ';transform: rotate(' + getAngle(arrLatlngs[i - 1], arrLatlngs[i], -1).toString() + 'deg)">▶</div>' });
      
      for (var c = 1; c <= arrowCount; c++) {
        result.push(L.marker(myMidPoint(arrLatlngs[i], arrLatlngs[i - 1], (c / (arrowCount + 1)), mapObj), { icon: icon }));
      }
    }
    return result;
  }

  function getAngle(latLng1, latlng2, coef) {
    var dy = latlng2[0] - latLng1[0];
    var dx = Math.cos(Math.PI / 180 * latLng1[0]) * (latlng2[1] - latLng1[1]);
    var ang = ((Math.atan2(dy, dx) / Math.PI) * 180 * coef);
    return (ang).toFixed(2);
  }

  function myMidPoint(latlng1, latlng2, per, mapObj) {
    if (!mapObj)
      throw new Error('map is not defined');

    var halfDist, segDist, dist, p1, p2, ratio,
      points = [];

    p1 = mapObj.project(new L.latLng(latlng1));
    p2 = mapObj.project(new L.latLng(latlng2));

    halfDist = distanceTo(p1, p2) * per;

    if (halfDist === 0)
      return mapObj.unproject(p1);

    dist = distanceTo(p1, p2);

    if (dist > halfDist) {
      ratio = (dist - halfDist) / dist;
      var res = mapObj.unproject(new Point(p2.x - ratio * (p2.x - p1.x), p2.y - ratio * (p2.y - p1.y)));
      return [res.lat, res.lng];
    }

  }

  function distanceTo(p1, p2) {
    var x = p2.x - p1.x,
      y = p2.y - p1.y;

    return Math.sqrt(x * x + y * y);
  }

  function toPoint(x, y, round) {
    if (x instanceof Point) {
      return x;
    }
    if (isArray(x)) {
      return new Point(x[0], x[1]);
    }
    if (x === undefined || x === null) {
      return x;
    }
    if (typeof x === 'object' && 'x' in x && 'y' in x) {
      return new Point(x.x, x.y);
    }
    return new Point(x, y, round);
  }

  function Point(x, y, round) {
    this.x = (round ? Math.round(x) : x);
    this.y = (round ? Math.round(y) : y);
  }  
</script>

<script>
  var map = new L.Map('map', {
    center: new L.LatLng(-27.331143, -55.865720),
    zoom: 16
  });

  L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', { attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors' }).addTo(map);

  var coordenadas = [
			[-27.326829,-55.873226],
			[-27.326941,-55.873211],
			[-27.327009,-55.873212],
			[-27.328227,-55.873174],
			[-27.329667,-55.873043],
			[-27.329517,-55.871357],
			[-27.330815,-55.871169],
			[-27.330997,-55.872875],
			[-27.332346,-55.872744],
			[-27.332286,-55.872157],
			[-27.33216,-55.871041],
			[-27.333232,-55.870912],
			[-27.334571,-55.870767],
			[-27.334454,-55.869286],
			[-27.333148,-55.869458],
			[-27.332007,-55.869595],
			[-27.331881,-55.868086],
			[-27.333029,-55.867949],
			[-27.334368,-55.867836],
			[-27.335701,-55.867667],
			[-27.335857,-55.869176],
			[-27.334454,-55.869286],
			[-27.334368,-55.867836],
			[-27.334257,-55.866322],
			[-27.334087,-55.864497],
			[-27.333929,-55.863029],
			[-27.332595,-55.863179],
			[-27.331499,-55.863276],
			[-27.330138,-55.863436],
			[-27.328796,-55.863581],
			[-27.3275,-55.863729],
			[-27.326150,-55.863861],
			[-27.326017,-55.862400],
			[-27.326169,-55.862385],
			[-27.327365,-55.862258],
			[-27.328675,-55.862123],
			[-27.329972,-55.86198],
			[-27.331353,-55.861813],
			[-27.33123,-55.860324],
			[-27.331129,-55.858869],
			[-27.329720,-55.859033],
			[-27.329768,-55.859568],
			[-27.329839,-55.86046],
			[-27.328562,-55.860642],
			[-27.328428,-55.859181],
			[-27.327096,-55.859310],
			[-27.327140,-55.859756],
			[-27.327237,-55.860781],
			[-27.325797,-55.860911],
			[-27.325905,-55.862412],
			[-27.326169,-55.862385],
			[-27.327365,-55.862258],
			[-27.3275,-55.863729],
			[-27.327601,-55.865216],
			[-27.327736,-55.867021],
			[-27.327859,-55.868491],
			[-27.328001,-55.870002],
			[-27.326493,-55.870136],
			[-27.326721,-55.871574],
			[-27.327129,-55.871547],
			[-27.328106,-55.871499],
			[-27.329517,-55.871357],
			[-27.329397,-55.869861],
			[-27.328001,-55.870002],
			[-27.328106,-55.871499],
			[-27.328227,-55.873174],
			[-27.329667,-55.873043],
			[-27.330997,-55.872875],
			[-27.332346,-55.872744],
			[-27.333449,-55.872601],
			[-27.334764,-55.872463],
			[-27.334708,-55.871799],
			[-27.334571,-55.870767],
			[-27.335929,-55.870611],
			[-27.337278,-55.870477],
			[-27.337138,-55.869009],
			[-27.337011,-55.867544],
			[-27.338390,-55.867381],
			[-27.339723,-55.867244],
			[-27.339599,-55.865711],
			[-27.338264,-55.865899],
			[-27.336918,-55.866046],
			[-27.335577,-55.866204],
			[-27.334257,-55.866322],
			[-27.332904,-55.866507],
			[-27.331825,-55.86659],
			[-27.330481,-55.866748],
			[-27.330592,-55.868234],
			[-27.330718,-55.869724],
			[-27.329397,-55.869861],
			[-27.329262,-55.868368],
			[-27.330592,-55.868234],
			[-27.331881,-55.868086],
			[-27.331825,-55.86659],
			[-27.331671,-55.864766],
			[-27.331499,-55.863276],
			[-27.331353,-55.861813],
			[-27.332442,-55.861706],
			[-27.333776,-55.861567],
			[-27.333692,-55.860046],
			[-27.332329,-55.860228],
			[-27.332442,-55.861706],
			[-27.332595,-55.863179],
			[-27.332738,-55.864653],
			[-27.332904,-55.866507],
			[-27.333029,-55.867949],
			[-27.333148,-55.869458],
			[-27.333232,-55.870912],
			[-27.333436,-55.872481],
			[-27.332329,-55.872603],
			[-27.332286,-55.872157],
			[-27.33216,-55.871041],
			[-27.332007,-55.869595],
			[-27.330718,-55.869724],
			[-27.330815,-55.871169],
			[-27.33216,-55.871041],
			[-27.333232,-55.870912],
			[-27.333449,-55.872601],
			[-27.334764,-55.872463],
			[-27.335866,-55.872297],
			[-27.335942,-55.872280],
			[-27.336142,-55.872403],
			[-27.336270,-55.872291],
			[-27.336258,-55.872098],
			[-27.336045,-55.872041],
			[-27.335965,-55.872102],
			[-27.335847,-55.872133],
			[-27.334749,-55.872306],
			[-27.334708,-55.871799],
			[-27.334571,-55.870767],
			[-27.335929,-55.870611],
			[-27.337278,-55.870477],
			[-27.338646,-55.870346],
			[-27.339980,-55.870223],
			[-27.339846,-55.868719],
			[-27.339723,-55.867244],
			[-27.341020,-55.867063],
			[-27.341149,-55.868285],
			[-27.340992,-55.868717],
			[-27.339846,-55.868719],
			[-27.338509,-55.868878],
			[-27.338646,-55.870346],
			[-27.339980,-55.870223],
			[-27.342155,-55.869352],
			[-27.340992,-55.868717],
			[-27.339846,-55.868719],
			[-27.338509,-55.868878],
			[-27.337138,-55.869009],
			[-27.335857,-55.869176],
			[-27.335929,-55.870611],
			[-27.337278,-55.870477],
			[-27.337138,-55.869009],
			[-27.337011,-55.867544],
			[-27.336918,-55.866046],
			[-27.336776,-55.864209],
			[-27.338104,-55.864063],
			[-27.339447,-55.863910],
			[-27.339311,-55.862423],
			[-27.337974,-55.862573],
			[-27.336604,-55.862742],
			[-27.336466,-55.861256],
			[-27.336354,-55.859791],
			[-27.335072,-55.85993],
			[-27.335127,-55.86139],
			[-27.335254,-55.862868],
			[-27.335417,-55.864358],
			[-27.336776,-55.864209],
			[-27.336604,-55.862742],
			[-27.335254,-55.862868],
			[-27.333929,-55.863029],
			[-27.333776,-55.861567],
			[-27.335127,-55.86139],
			[-27.336466,-55.861256],
			[-27.337848,-55.861109],
			[-27.339167,-55.860947],
			[-27.340578,-55.860805],
			[-27.341822,-55.860662],
			[-27.343070,-55.860619],
			[-27.343256,-55.860204],
			[-27.343609,-55.859420],
			[-27.343709,-55.859264],
			[-27.343009,-55.858896],
			[-27.342914,-55.859026],
			[-27.341712,-55.859189],
			[-27.340462,-55.859320],
			[-27.340578,-55.860805],
			[-27.340671,-55.862284],
			[-27.340736, -55.863742],
			[-27.340934,-55.865588],
			[-27.341020,-55.867063],
			[-27.341575,-55.867368],
			[-27.342730,-55.868004],
			[-27.343318,-55.866668],
			[-27.342133,-55.866029],
			[-27.340934,-55.865588],
			[-27.339599,-55.865711],
			[-27.339447,-55.863910],
			[-27.340736, -55.863742],
			[-27.341541,-55.864043],
			[-27.342702,-55.864665],
			[-27.343878,-55.865367],
			[-27.344465,-55.864028],
			[-27.343318,-55.863359],
			[-27.342134,-55.862691],
			[-27.342068,-55.862577],
			[-27.341988,-55.862180],
			[-27.340671,-55.862284],
			[-27.339311,-55.862423],
			[-27.339167,-55.860947],
			[-27.339049,-55.859473],
			[-27.338940,-55.858040],
			[-27.337586,-55.858169],
			[-27.337632,-55.858667],
			[-27.337711,-55.859630],
			[-27.337848,-55.861109],
			[-27.337974,-55.862573],
			[-27.338104,-55.864063],
			[-27.338264,-55.865899],
			[-27.338390,-55.867381],
			[-27.338509,-55.868878],
			[-27.337138,-55.869009],
			[-27.337011,-55.867544],
			[-27.336918,-55.866046],
			[-27.335577,-55.866204],
			[-27.335701,-55.867667],
			[-27.337011,-55.867544],
			[-27.336918,-55.866046],
			[-27.335577,-55.866204],
			[-27.334257,-55.866322],
			[-27.334087,-55.864497],
			[-27.335417,-55.864358],
			[-27.335577,-55.866204],
			[-27.334257,-55.866322],
			[-27.332904,-55.866507],
			[-27.331825,-55.86659],
			[-27.331671,-55.864766],
			[-27.332738,-55.864653],
			[-27.334087,-55.864497],
			[-27.333929,-55.863029],
			[-27.333776,-55.861567],
			[-27.333692,-55.860046],
			[-27.333567,-55.858612],
			[-27.332236,-55.858731],
			[-27.332296,-55.859264],
			[-27.332329,-55.860228],
			[-27.33123,-55.860324],
			[-27.329839,-55.86046],
			[-27.329972,-55.86198],
			[-27.330138,-55.863436],
			[-27.330327,-55.864916],
			[-27.330481,-55.866748],
			[-27.329139,-55.866893],
			[-27.327736,-55.867021],
			[-27.326330,-55.867174],
			[-27.326461,-55.868655],
			[-27.326902,-55.868605],
			[-27.327859,-55.868491],
			[-27.329262,-55.868368],
			[-27.329139,-55.866893],
			[-27.328954,-55.865077],
			[-27.330327,-55.864916],
			[-27.331671,-55.864766],
			[-27.331499,-55.863276],
			[-27.330138,-55.863436],
			[-27.328796,-55.863581],
			[-27.328675,-55.862123],
			[-27.328562,-55.860642],
			[-27.327237,-55.860781],
			[-27.327365,-55.862258],
			[-27.3275,-55.863729],
			[-27.327601,-55.865216],
			[-27.328954,-55.865077],
			[-27.328796,-55.863581],
			[-27.3275,-55.863729],
			[-27.326025,-55.863869],
			[-27.326151,-55.865342],
			[-27.326460,-55.865313],
			[-27.327601,-55.865216],
			[-27.328954,-55.865077],
			[-27.328796,-55.863581],
			[-27.328675,-55.862123],
			[-27.328562,-55.860642],
			[-27.328439,-55.859325],
			[-27.329732,-55.859180],
			[-27.331148,-55.859022],
			[-27.332253,-55.858886],
			[-27.333577,-55.858722],
			[-27.334939,-55.858615],
			[-27.334973,-55.858973],
			[-27.335072,-55.85993],
			[-27.333692,-55.860046],
			[-27.333577,-55.858722],
			[-27.334939,-55.858615],
			[-27.336254,-55.858462],
			[-27.337599,-55.858326],
			[-27.338940,-55.858177],
			[-27.340374,-55.858048],
			[-27.340401,-55.858446],
			[-27.340462,-55.859320],
			[-27.339049,-55.859473],
			[-27.337711,-55.859630],
			[-27.336354,-55.859791],
			[-27.336254,-55.858462],
			[-27.337599,-55.858326],
			[-27.338940,-55.858177],
			[-27.340374,-55.858048],
			[-27.341082,-55.857982],
			[-27.341675,-55.857895],
			[-27.343303,-55.857820],
			[-27.344303,-55.857855],
			[-27.345497,-55.858072],
			[-27.345150,-55.859018],
   ];

  const sleep = ms => new Promise(r => setTimeout(r, ms));

  async function printLine() {
    for (let i = 0; i < coordenadas.length; i++) {
      await sleep(50);
      /*if (i >= 1 && i % 1 === 0) {
        // Elimina las líneas y flechas anteriores cada 1 línea
        map.eachLayer(function (layer) {
          if (layer instanceof L.Polyline || layer instanceof L.Marker) {
            map.removeLayer(layer);
          }
        });
      }*/
      var polyline = L.polyline([coordenadas[i], coordenadas[i + 1]], { edit_with_drag: false }).addTo(map);
      L.featureGroup(getArrows([coordenadas[i], coordenadas[i + 1]], 'green', 1, map)).addTo(map);
    }
    printLine();
  }
  printLine()

</script>


</html>